<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>My CaseLynx Fee Estimator</title>
  <!-- Brand fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Cabinet+Grotesk:wght@600;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root{
      --clx-blue:#2C39DB;
      --clx-sky:#6E80FF;
      --clx-text:#1A1A1A;
      --clx-muted:#555;
      --clx-border:#E6E8F0;
    }
    *{box-sizing:border-box}
    body{
      font-family: Roboto, system-ui, -apple-system, Segoe UI, Arial, sans-serif;
      margin:0;
      color:var(--clx-text);
      background:#fafbff;
    }
    .wrap{
      max-width:760px;margin:32px auto;padding:24px;
      background:#fff;border:1px solid var(--clx-border);border-radius:16px;
      box-shadow:0 6px 24px rgba(44,57,219,.06);
    }
    .brandbar{
      height:6px;background:linear-gradient(90deg,var(--clx-blue),var(--clx-sky));
      border-radius:6px;margin:0 0 16px;
    }
    h1{
      font-family:"Cabinet Grotesk", Roboto, sans-serif;
      margin:0 0 4px;font-size:24px;line-height:1.2;font-weight:700;
    }
    p.lead{margin:4px 0 16px;color:var(--clx-muted)}
    form{display:grid;gap:16px;margin-top:8px}
    label{font-weight:600;font-size:14px}
    input,select{
      width:100%;padding:12px;border:1px solid var(--clx-border);
      border-radius:10px;font-size:16px;background:#fff;
    }
    .row{display:grid;gap:12px;grid-template-columns:1fr 1fr}
    @media (max-width:640px){ .row{grid-template-columns:1fr} }
    fieldset{
      border:1px solid var(--clx-border);border-radius:12px;padding:14px;margin:0;
    }
    legend{
      padding:0 8px;font-weight:800;color:#222;font-size:14px;
      font-family:"Cabinet Grotesk", Roboto, sans-serif;
    }
    .hint{color:var(--clx-muted);font-size:12px;margin-top:4px}
    .result{
      display:none;border:1px solid var(--clx-border);border-radius:12px;padding:14px;
      background:#fcfdff;
    }
    .result .top{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
    .total{font-weight:800;font-size:20px}
    .bd{color:var(--clx-muted);line-height:1.6}
    button{
      padding:12px 14px;border:none;border-radius:10px;cursor:pointer;
      font-weight:700;font-size:14px;background:var(--clx-blue);color:#fff;
    }
    .footer{margin-top:18px;color:#6b7280;font-size:12px}
    .footnote{
      margin-top:2px;
      font-size:13px;
      color:#676767;
      line-height:1.5;
    }
    .actions{display:flex;gap:8px}
    .muted{color:#666}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="brandbar"></div>
    <h1>My CaseLynx Fee Estimator</h1>
    <p class="lead">Generate an estimated fee for expert work (exam/review + any selected services).</p>

    <form id="estimator" onsubmit="return false;">
      <!-- Core case details -->
      <fieldset>
        <legend>Core Case</legend>
        <div class="row">
          <label>Case Type
            <select id="caseType" name="case_type" onchange="recalc()">
              <option value="exam" selected>IME / CME (exam + report)</option>
              <option value="review">Record Review Only (report)</option>
            </select>
          </label>

          <label>Estimated # Record Pages
            <input id="pages" name="pages" type="number" min="1" step="1" placeholder="Enter pages" required oninput="recalc()" />
          </label>
        </div>
        <div class="hint">
          Base: $5,000 for IME/CME, $2,500 for Record Review (includes up to 600 pages). Page overage uses tiered rates.
        </div>
      </fieldset>

      <!-- Imaging Review -->
      <fieldset>
        <legend>Imaging Review (optional)</legend>
        <div class="row">
          <label>X-ray / standard studies (#)
            <input id="xrays" type="number" min="0" step="1" value="0" oninput="recalc()" />
          </label>
          <label>MRI / CT studies (#)
            <input id="mricts" type="number" min="0" step="1" value="0" oninput="recalc()" />
          </label>
        </div>
        <div class="hint">X-ray/standard: $75 per study; MRI/CT: $150 per study.</div>
      </fieldset>

      <!-- Addendum -->
      <fieldset>
        <legend>Addendum Review & Report (optional)</legend>
        <div class="row">
          <label>Addendum pages (total)
            <input id="addPages" type="number" min="0" step="1" value="0" oninput="recalc()" />
          </label>
          <label class="muted">Reference limit
            <input disabled value="Up to 200 pages included in flat fee" />
          </label>
        </div>
        <div class="hint">$1,000 flat covers up to 200 pages; additional pages billed at $5/page.</div>
      </fieldset>

      <!-- Meetings & Travel -->
      <fieldset>
        <legend>Meetings & Travel (optional)</legend>
        <div class="row">
          <label>Teleconference / attorney meeting (minutes)
            <input id="teleMin" type="number" min="0" step="5" value="0" oninput="recalc()" />
          </label>
          <label>Travel time (hours)
            <input id="travelHrs" type="number" min="0" step="0.25" value="0" oninput="recalc()" />
          </label>
        </div>
        <div class="hint">Teleconference billed $500 per 30 min (rounded up). Travel billed $750 per hour.</div>
      </fieldset>

      <!-- Court-related services -->
      <fieldset>
        <legend>Court-Related Services (optional)</legend>
        <div class="row">
          <label>Deposition hours (expected)
            <input id="depoHrs" type="number" min="0" step="0.5" value="0" oninput="recalc()" />
          </label>
          <label>Preparation for testimony (hours)
            <input id="prepHrs" type="number" min="0" step="0.5" value="0" oninput="recalc()" />
          </label>
        </div>
        <div class="row">
          <label>Testimony type
            <select id="testimonyType" onchange="recalc()">
              <option value="none" selected>None</option>
              <option value="inperson">In-person testimony</option>
              <option value="virtual">Virtual testimony</option>
            </select>
          </label>
          <label>Testimony days
            <input id="testimonyDays" type="number" min="0" step="1" value="0" oninput="recalc()" />
          </label>
        </div>
        <div class="hint">
          Deposition: $2,500 first 2 hours (minimum), then $1,000/hour thereafter. Testimony: In-person $10,000/day; Virtual $5,000/day. Prep: $1,000/hour.
        </div>
      </fieldset>

      <!-- Result -->
      <div id="result" class="result">
        <div class="top">
          <strong>Estimated Total</strong>
          <div id="total" class="total"></div>
        </div>
        <div id="breakdown" class="bd"></div>
      </div>

      <div class="actions">
        <button onclick="recalc()">Calculate</button>
        <button type="reset" onclick="setTimeout(recalc,0)">Reset</button>
      </div>
    </form>

    <p class="footnote">
      Disclaimer: This estimate reflects selections above and excludes other ad hoc services or policy adjustments (e.g., cancellations, late fees).
      Final invoices will reflect actual work performed and payment terms.
    </p>

    <div class="footer">© CaseLynx</div>
  </div>

<script>
  const USD = n => n.toLocaleString(undefined,{style:'currency',currency:'USD',maximumFractionDigits:0});

  function pageOverage(pages){
    // Tiers: 600–1,000 = $5/page; 1,000–5,000 = $3/page; 5,000+ = $1/page
    const t1 = Math.max(0, Math.min(pages, 1000) - 600) * 5;
    const t2 = Math.max(0, Math.min(pages, 5000) - 1000) * 3;
    const t3 = Math.max(0, pages - 5000) * 1;
    return { t1, t2, t3, total: t1 + t2 + t3 };
  }

  function calcCore(pages, type){
    const base = (type === 'review') ? 2500 : 5000;
    const over = pageOverage(pages);
    return { base, over, total: base + over.total };
  }

  function calcImaging(xrayCount, mriCtCount){
    const xr = Math.max(0, xrayCount|0) * 75;
    const mc = Math.max(0, mriCtCount|0) * 150;
    return { xr, mc, total: xr + mc };
  }

  function calcAddendum(addPages){
    const p = Math.max(0, addPages|0);
    if (p === 0) return { flat:0, extra:0, total:0 };
    const flat = 1000; // up to 200 pages
    const extra = Math.max(0, p - 200) * 5;
    return { flat, extra, total: flat + extra };
  }

  function calcMeetings(teleMinutes, travelHours){
    const teleBlocks = Math.ceil(Math.max(0, teleMinutes)/30);
    const tele = teleBlocks * 500;
    const travel = Math.max(0, Number(travelHours) || 0) * 750;
    return { tele, travel, total: tele + travel, teleBlocks };
  }

  function calcCourt(depoHrs, prepHrs, testimonyType, testimonyDays){
    // Deposition: $2,500 includes first 2 hours (minimum if >0), then $1,000/hr thereafter
    const dH = Math.max(0, Number(depoHrs) || 0);
    const deposition = (dH > 0) ? (2500 + Math.max(0, dH - 2) * 1000) : 0;

    // Prep: $1,000 / hr
    const prep = Math.max(0, Number(prepHrs) || 0) * 1000;

    // Testimony: In-person $10k/day; Virtual $5k/day
    const days = Math.max(0, testimonyDays|0);
    let testimony = 0;
    if (testimonyType === 'inperson') testimony = days * 10000;
    if (testimonyType === 'virtual')  testimony = days * 5000;

    return { deposition, prep, testimony, total: deposition + prep + testimony };
  }

  function recalc(){
    const resultBox = document.getElementById('result');

    const type  = document.getElementById('caseType').value;
    const pages = parseInt(document.getElementById('pages').value, 10);

    const xray  = parseInt(document.getElementById('xrays').value, 10);
    const mriCt = parseInt(document.getElementById('mricts').value, 10);

    const addPg = parseInt(document.getElementById('addPages').value, 10);

    const teleM = parseInt(document.getElementById('teleMin').value, 10);
    const travH = parseFloat(document.getElementById('travelHrs').value);

    const depoH = parseFloat(document.getElementById('depoHrs').value);
    const prepH = parseFloat(document.getElementById('prepHrs').value);
    const testT = document.getElementById('testimonyType').value;
    const testD = parseInt(document.getElementById('testimonyDays').value, 10);

    if (!pages || pages < 1){
      resultBox.style.display = 'none';
      document.getElementById('breakdown').innerHTML = '';
      document.getElementById('total').textContent = '';
      return;
    }

    // Components
    const core = calcCore(pages, type);
    const img  = calcImaging(xray||0, mriCt||0);
    const add  = calcAddendum(addPg||0);
    const mtg  = calcMeetings(teleM||0, travH||0);
    const crt  = calcCourt(depoH||0, prepH||0, testT, testD||0);

    const grandTotal = core.total + img.total + add.total + mtg.total + crt.total;

    // Breakdown
    const parts = [];

    // Core
    parts.push("Base (" + (type === 'review' ? "Record Review" : "IME/CME") + ", up to 600 pages): " + USD(core.base));
    const over = core.over;
    if (over.t1) parts.push("$5/page for pages 601–" + Math.min(pages,1000) + ": " + USD(over.t1));
    if (over.t2) parts.push("$3/page for pages 1,001–" + Math.min(pages,5000) + ": " + USD(over.t2));
    if (over.t3) parts.push("$1/page for pages 5,001–" + pages + ": " + USD(over.t3));

    // Imaging
    if (img.xr) parts.push("Imaging – X-ray/standard (" + (xray||0) + "): " + USD(img.xr));
    if (img.mc) parts.push("Imaging – MRI/CT (" + (mriCt||0) + "): " + USD(img.mc));

    // Addendum
    if (add.total){
      parts.push("Addendum review & report (flat): " + USD(add.flat));
      if (add.extra) parts.push("Addendum extra pages (" + Math.max(0,(addPg||0)-200) + " @ $5/page): " + USD(add.extra));
    }

    // Meetings & travel
    if (mtg.tele) parts.push("Teleconference (" + mtg.teleBlocks + " × 30 min): " + USD(mtg.tele));
    if (mtg.travel) parts.push("Travel time (" + (travH||0) + " hrs): " + USD(mtg.travel));

    // Court-related
    if (crt.deposition) parts.push("Deposition (incl. first 2 hrs): " + USD(crt.deposition));
    if (crt.prep)       parts.push("Preparation for testimony (" + (prepH||0) + " hrs): " + USD(crt.prep));
    if (crt.testimony){
      if (testT === 'inperson') parts.push("Court testimony – In-person (" + (testD||0) + " day[s]): " + USD(crt.testimony));
      if (testT === 'virtual')  parts.push("Court testimony – Virtual (" + (testD||0) + " day[s]): " + USD(crt.testimony));
    }

    // Render
    document.getElementById('total').textContent = USD(grandTotal);
    document.getElementById('breakdown').innerHTML = parts.map(x => "• " + x).join("<br>");
    resultBox.style.display = 'block';
  }
</script>
</body>
</html>
