<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MyCaseLynx Fee Estimator</title>
  <link href="https://fonts.googleapis.com/css2?family=Cabinet+Grotesk:wght@600;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root{
      --clx-blue:#2C39DB; --clx-sky:#6E80FF; --clx-text:#1A1A1A;
      --clx-muted:#616161; --clx-border:#E6E8F0; --clx-bg:#fafbff; --clx-chip:#eef2ff;
    }
    *{box-sizing:border-box}
    body{font-family:Roboto,system-ui,-apple-system,Segoe UI,Arial,sans-serif;margin:0;color:var(--clx-text);background:var(--clx-bg)}
    .wrap{max-width:760px;margin:32px auto;padding:24px;background:#fff;border:1px solid var(--clx-border);border-radius:16px;box-shadow:0 6px 24px rgba(44,57,219,.06)}
    .brandbar{height:6px;background:linear-gradient(90deg,var(--clx-blue),var(--clx-sky));border-radius:6px;margin:0 0 16px}
    h1{font-family:"Cabinet Grotesk",Roboto,sans-serif;margin:0 0 4px;font-size:24px;line-height:1.2;font-weight:700}
    p.lead{margin:4px 0 16px;color:var(--clx-muted)}
    form{display:grid;gap:12px;margin-top:8px}
    label{font-weight:600;font-size:14px}
    input,select{width:100%;padding:12px;border:1px solid var(--clx-border);border-radius:10px;font-size:16px;background:#fff}
    .row{display:grid;gap:12px;grid-template-columns:1fr 1fr}
    @media (max-width:640px){.row{grid-template-columns:1fr}}

    details{border:1px solid var(--clx-border);border-radius:12px;background:#fff;overflow:hidden}
    summary{list-style:none;cursor:pointer;padding:14px 16px;display:flex;gap:8px;align-items:center;font-family:"Cabinet Grotesk",Roboto,sans-serif;font-weight:700;background:#fff}
    summary::-webkit-details-marker{display:none}
    .caret{width:10px;height:10px;border-right:2px solid #7a7a7a;border-bottom:2px solid #7a7a7a;transform:rotate(-45deg);transition:transform .2s ease}
    details[open] .caret{transform:rotate(45deg)}
    .panel{padding:14px 16px;border-top:1px solid var(--clx-border);display:grid;gap:12px}
    .badge{background:var(--clx-chip);color:#3730a3;font-weight:700;border-radius:999px;padding:2px 8px;font-size:11px}
    .hint{color:var(--clx-muted);font-size:12px;margin-top:4px}

    /* Optional note (prominent) */
    .optional-note{
      display:flex; align-items:center; gap:8px;
      margin:6px 2px 0 2px; padding:10px 12px;
      background:#f5f7ff; border:1px solid var(--clx-border); border-radius:10px;
      font-size:15px; font-weight:700; color:#2a2a2a;
    }

    .result{display:none;border:1px solid var(--clx-border);border-radius:12px;padding:0;background:#fcfdff}
    .result .top{display:flex;justify-content:space-between;align-items:center;padding:12px 14px}
    .total{font-weight:800;font-size:20px}
    .bd{border-top:1px solid var(--clx-border);padding:10px 14px}
    .lines{display:grid;gap:6px}
    .line{display:grid;grid-template-columns:1fr auto;gap:12px;align-items:center;font-size:14px;color:#374151}
    .amount{font-variant-numeric:tabular-nums;font-weight:700}
    .actions{display:flex;gap:8px;margin-top:4px}
    button{padding:12px 14px;border:none;border-radius:10px;cursor:pointer;font-weight:700;font-size:14px;background:var(--clx-blue);color:#fff}
    .btn-ghost{background:#eef2ff;color:#1f2aeb}
    .footnote{margin-top:10px;font-size:12.5px;color:#676767;line-height:1.5}
    .footer{margin-top:14px;color:#6b7280;font-size:12px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="brandbar"></div>
    <h1>MyCaseLynx Fee Estimator</h1>
    <p class="lead">Generate an estimated fee for expert work.</p>

    <form id="estimator" onsubmit="return false;">

      <!-- Core Case -->
      <details open>
        <summary><span class="caret"></span>Core Case</summary>
        <div class="panel">
          <div class="row">
            <label>Case Type
              <select id="caseType" name="case_type" onchange="recalc()">
                <option value="exam" selected>IME/CME (exam + report)</option>
                <option value="review">Record review only</option>
              </select>
            </label>
            <label>Estimated # Record Pages
              <input id="pages" name="pages" type="number" min="1" step="1" placeholder="Enter pages" required oninput="recalc()" />
            </label>
          </div>
          <div class="hint">Base: $5,000 (IME/CME) or $2,500 (Record Review). Both include up to 600 pages. Tiered page overage applies beyond 600.</div>
        </div>
      </details>

      <!-- Optional sections notice -->
      <div class="optional-note">
        <span class="badge">Optional</span> The sections below are not required—expand only if they apply.
      </div>

      <!-- Imaging Review (optional) -->
      <details>
        <summary><span class="caret"></span>Imaging Review <span class="badge">Optional</span></summary>
        <div class="panel">
          <div class="row">
            <label>X-ray / standard studies (#)
              <input id="xrays" type="number" min="0" step="1" value="0" oninput="recalc()" />
            </label>
            <label>MRI / CT studies (#)
              <input id="mricts" type="number" min="0" step="1" value="0" oninput="recalc()" />
            </label>
          </div>
          <div class="hint">X-ray/standard: $75 per study; MRI/CT: $150 per study.</div>
        </div>
      </details>

      <!-- Addendum (optional) -->
      <details>
        <summary><span class="caret"></span>Addendum Review & Report <span class="badge">Optional</span></summary>
        <div class="panel">
          <div class="row">
            <label>Addendum records pages for review
              <input id="addPages" type="number" min="0" step="1" value="0" oninput="recalc()" />
            </label>
          </div>
          <div class="hint">Includes up to 200 addendum pages (and up to 6 images). Pages beyond 200 are billed at $5/page. Images beyond 6 should be added under Imaging Review.</div>
        </div>
      </details>

      <!-- Meetings (optional) -->
      <details>
        <summary><span class="caret"></span>Teleconference Meetings <span class="badge">Optional</span></summary>
        <div class="panel">
          <div class="row">
            <label>Number of meetings
              <input id="teleCount" type="number" min="0" step="1" value="0" oninput="recalc()" />
            </label>
          </div>
          <div class="hint">Billed at $500 per meeting.</div>
        </div>
      </details>

      <!-- Travel (optional) -->
      <details>
        <summary><span class="caret"></span>Travel <span class="badge">Optional</span></summary>
        <div class="panel">
          <div class="row">
            <label>Travel time (hours)
              <input id="travelHrs" type="number" min="0" step="0.25" value="0" oninput="recalc()" />
            </label>
          </div>
          <div class="hint">Billed at $750 per hour (rounded to the nearest whole hour).</div>
        </div>
      </details>

      <!-- Court-related (optional) -->
      <details>
        <summary><span class="caret"></span>Court-Related Services <span class="badge">Optional</span></summary>
        <div class="panel">
          <div class="row">
            <label>Deposition hours (expected)
              <input id="depoHrs" type="number" min="0" step="0.5" value="0" oninput="recalc()" />
            </label>
            <label>Preparation for testimony (hours)
              <input id="prepHrs" type="number" min="0" step="0.5" value="0" oninput="recalc()" />
            </label>
          </div>
          <div class="row">
            <label>Testimony type
              <select id="testimonyType" onchange="recalc()">
                <option value="none" selected>None</option>
                <option value="inperson">In-person testimony</option>
                <option value="virtual">Virtual testimony</option>
              </select>
            </label>
            <label>Testimony days
              <input id="testimonyDays" type="number" min="0" step="1" value="0" oninput="recalc()" />
            </label>
          </div>
          <div class="hint">Deposition: $2,500 first 2 hours (minimum), then $1,000/hour thereafter. Prep: $1,000/hour. Testimony: In-person $10,000/day; Virtual $5,000/day.</div>
        </div>
      </details>

      <!-- Result -->
      <div id="result" class="result">
        <div class="top">
          <strong>Estimated Total</strong>
          <div id="total" class="total"></div>
        </div>
        <div class="bd"><div id="lines" class="lines"></div></div>
      </div>

      <div class="actions">
        <button onclick="recalc()">Calculate</button>
        <button type="reset" class="btn-ghost" onclick="setTimeout(recalc,0)">Reset</button>
      </div>
    </form>

    <p class="footnote">
      This calculator provides a non-binding estimate based on your inputs. Final billing reflects actual services rendered,
      agreed terms, and any policy items (e.g., rescheduling/cancellation, late fees). Estimates may change if scope changes.
    </p>

    <div class="footer">© CaseLynx</div>
  </div>

<script>
  const USD = n => (Number.isFinite(n) ? n : 0).toLocaleString(
    undefined,{style:'currency',currency:'USD',maximumFractionDigits:0}
  );

  /* Core & Overage */
  function pageOverage(pages){
    const p = Math.max(0, pages|0);
    const t1 = Math.max(0, Math.min(p,1000) - 600) * 5;
    const t2 = Math.max(0, Math.min(p,5000) - 1000) * 3;
    const t3 = Math.max(0, p - 5000) * 1;
    return { t1, t2, t3, total: t1 + t2 + t3 };
  }
  function calcCore(pages, type){
    const base = (type === 'review') ? 2500 : 5000;
    const over = pageOverage(pages);
    return { base, over, total: base + over.total };
  }

  /* Imaging */
  function calcImaging(xrayCount, mriCtCount){
    const xr = Math.max(0, xrayCount|0) * 75;
    const mc = Math.max(0, mriCtCount|0) * 150;
    return { xr, mc, total: xr + mc };
  }

  /* Addendum */
  function calcAddendum(addPages){
    const p = Math.max(0, addPages|0);
    if (p === 0) return { flat:0, extra:0, total:0, pages:0 };
    const flat = 1000;
    const extra = Math.max(0, p - 200) * 5;
    return { flat, extra, total: flat + extra, pages:p };
  }

  /* Teleconference Meetings (count-based) */
  function calcMeetings(meetingCount){
    const count = Math.max(0, meetingCount|0);
    const tele = count * 500;
    return { count, tele, total: tele };
  }

  /* Travel (rounded to nearest hour) */
  function calcTravel(travelHours){
    const hrs = Math.round(Math.max(0, Number(travelHours) || 0));
    const travel = hrs * 750;
    return { hrs, travel, total: travel };
  }

  /* Court */
  function calcCourt(depoHrs, prepHrs, testimonyType, testimonyDays){
    const dH = Math.max(0, Number(depoHrs) || 0);
    const deposition = (dH > 0) ? (2500 + Math.max(0, dH - 2) * 1000) : 0;
    const prep = Math.max(0, Number(prepHrs) || 0) * 1000;
    const days = Math.max(0, testimonyDays|0);
    let testimony = 0;
    if (testimonyType === 'inperson') testimony = days * 10000;
    if (testimonyType === 'virtual')  testimony = days * 5000;
    return { deposition, prep, testimony, total: deposition + prep + testimony };
  }

  function recalc(){
    const resultBox = document.getElementById('result');
    const linesEl = document.getElementById('lines');

    const type  = document.getElementById('caseType').value;
    const pages = parseInt(document.getElementById('pages').value, 10);

    const xray  = parseInt(document.getElementById('xrays')?.value || "0", 10);
    const mriCt = parseInt(document.getElementById('mricts')?.value || "0", 10);

    const addPg = parseInt(document.getElementById('addPages')?.value || "0", 10);

    const teleC = parseInt(document.getElementById('teleCount')?.value || "0", 10);
    const travH = parseFloat(document.getElementById('travelHrs')?.value || "0");

    const depoH = parseFloat(document.getElementById('depoHrs')?.value || "0");
    const prepH = parseFloat(document.getElementById('prepHrs')?.value || "0");
    const testT = document.getElementById('testimonyType')?.value || "none";
    const testD = parseInt(document.getElementById('testimonyDays')?.value || "0", 10);

    if (!pages || pages < 1){
      resultBox.style.display = 'none';
      linesEl.innerHTML = '';
      document.getElementById('total').textContent = '';
      return;
    }

    const core = calcCore(pages, type);
    const img  = calcImaging(xray, mriCt);
    const add  = calcAddendum(addPg);
    const mtg  = calcMeetings(teleC);
    const trv  = calcTravel(travH);
    const crt  = calcCourt(depoH, prepH, testT, testD);

    const grandTotal = core.total + img.total + add.total + mtg.total + trv.total + crt.total;

    const lines = [];
    // Core
    lines.push(["Base — " + (type === 'review' ? "Record Review" : "IME/CME") + " (up to 600 pages)", USD(core.base)]);
    const { t1, t2, t3 } = core.over;
    if (t1) lines.push([`Page overage 601–${Math.min(pages,1000)} @ $5/page`, USD(t1)]);
    if (t2) lines.push([`Page overage 1,001–${Math.min(pages,5000)} @ $3/page`, USD(t2)]);
    if (t3) lines.push([`Page overage 5,001–${pages} @ $1/page`, USD(t3)]);

    // Imaging
    if (img.xr) lines.push([`Imaging — X-ray/standard (${xray})`, USD(img.xr)]);
    if (img.mc) lines.push([`Imaging — MRI/CT (${mriCt})`, USD(img.mc)]);

    // Addendum
    if (add.total){
      lines.push([`Addendum review & report`, USD(add.flat)]);
      if (add.extra) lines.push([`Addendum extra pages (${Math.max(0, add.pages-200)} @ $5/page)`, USD(add.extra)]);
      /* no 'scope' line when there is no overage */
    }

    // Meetings
    if (mtg.tele) lines.push([`Teleconference meetings (${mtg.count})`, USD(mtg.tele)]);

    // Travel
    if (trv.travel) lines.push([`Travel time (${trv.hrs} hrs)`, USD(trv.travel)]);

    // Court
    if (crt.deposition) lines.push([`Deposition (incl. first 2 hrs)`, USD(crt.deposition)]);
    if (crt.prep)       lines.push([`Preparation for testimony (${prepH} hrs)`, USD(crt.prep)]);
    if (crt.testimony){
      const label = (testT === 'inperson') ? `Court testimony — In-person (${testD} day[s])`
                                           : `Court testimony — Virtual (${testD} day[s])`;
      lines.push([label, USD(crt.testimony)]);
    }

    document.getElementById('total').textContent = USD(grandTotal);
    linesEl.innerHTML = lines.map(([l,a]) => `<div class="line"><div>${l}</div><div class="amount">${a}</div></div>`).join("");
    resultBox.style.display = 'block';
  }
</script>
</body>
</html>
